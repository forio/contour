/*! Contour - v1.0.1 - 2016-07-22 */

!function(a,b){!function(a){var b=this;if("object"==typeof module&&module&&"object"==typeof module.exports&&"function"==typeof require&&(b.d3=require("d3"),b._=require("lodash")),!d3)throw new Error("You need to include d3.js before Contour. Go to http://d3js.org/");if(!_||!_.merge)throw new Error("You need to include lodash.js before Contour. Go to http://lodash.com/")}(),function(){var a=function(a){var b=nw.decDigits(a);return 0===b?1:Math.pow(10,b)},b=function(b,c){return Math.max(a(b),a(c))},c=function(a,c){var d=b(a,c),e=Math.round(a*d),f=Math.round(c*d);return(e+f)/d},d=function(a,c){var d=b(a,c),e=Math.round(a*d),f=Math.round(c*d);return(e-f)/d},e=function(a,c){var d=b(a,c),e=Math.round(a*d),f=Math.round(c*d);return e*f/(d*d)},f=function(a,c){var d=b(a,c),e=Math.round(a*d),f=Math.round(c*d);return e/f},g=function(){},h={getValue:function(a,b,c,d){return d=Array.prototype.slice.call(arguments,3),a?"function"==typeof a?a.apply(c,d):a:b},seriesNameToClass:function(a){return a||""}},i={cleanNullValues:function(){return function(a){return _.map(a,function(a){return _.extend(a,{data:_.reduce(a.data,function(a,b){return null!=b.y&&a.push(b),a},[])})})}},minMaxFilter:function(a){return function(b){if(b.length<=a)return b;for(var c=[b[0]],d=1,e=Math.floor(b.length/a);d<b.length-1;){for(var f,g,h=!1,i=Math.min(d+e,b.length),j=d;j<i;j++){var k=b[d];k.y&&((!h||k.y>f.y)&&(f=k),(!h||k.y<g.y)&&(g=k),h=!0)}h&&(g.x===f.x?c.push(g):g.x<f.x?(c.push(g),c.push(f)):g.x>f.x&&(c.push(f),c.push(g))),d+=Math.max(1,Math.min(b.length-1-d,e))}return c.push(b[b.length-1]),c}}},j={warn:function(a){console&&console.log&&console.log(a)}},k={firstAndLast:function(a){return[a[0],a[a.length-1]]},roundToNearest:function(a,b){return e(Math.ceil(f(a,b)),b)},roundTo:function(a,b){return f(Math.ceil(e(a,Math.pow(10,b))),Math.pow(10,b))},trunc:function(a){return a-a%1},digits:function(a){var b=Math.abs(a).toString(),c=b.split("e");return 2===c.length?Math.max(0,c[1])+1:(c=b.split("."),c[0].length)},decDigits:function(a){var b=Math.abs(a).toString(),c=b.split(".");return 2===c.length?c[1].length:(c=b.split("e"),2===c.length?-Math.min(0,c[1]):0)},log10:function(a){return Math.log(a)/Math.LN10},clamp:function(a,b,c){return a>c?c:a<b?b:a},clampLeft:function(a,b){return a<b?b:a},clampRight:function(a,b){return a>b?b:a},degToRad:function(a){return a*Math.PI/180},radToDeg:function(a){return 180*a/Math.PI},rotatePoint:function(a,b){return{x:a.x*Math.cos(b)-a.y*Math.sin(b),y:a.x*Math.sin(b)+a.y*Math.cos(b)}},translatePoint:function(a,b){return{x:a.x+b.x,y:a.y+b.y}},linearRegression:function(a){for(var b={},c=a.length,d=0,e=0,f=0,g=0,h=0,i=0;i<c;i++)d+=a[i].x,e+=a[i].y,f+=a[i].x*a[i].y,g+=a[i].x*a[i].x,h+=a[i].y*a[i].y;return b.slope=(c*f-d*e)/(c*g-d*d),b.intercept=(e-b.slope*d)/c,b.r2=Math.pow((c*f-d*e)/Math.sqrt((c*g-d*d)*(c*h-e*e)),2),b},niceRound:function(a){return Math.ceil(a+.1*a)}},l={addAxis:function(a,b){nw.axes=nw.axes||{},nw.axes[a]=b},roundToNextTick:function(a){var b,c,d=Math.abs(a),f=d===a?1:-1;if(d>=1)b=Math.floor(nw.log10(d)),c=b<=1?2:Math.pow(10,b-1);else{var g=d.toExponential().replace(/\.|e-\d+$/g,"");b=g.length,c=e(1===b?2:10,Math.pow(10,-b))}var h=nw.roundToNearest(d,c);return f*h},niceMinMax:function(a,b,g,h){if(a>b)return{min:a,max:a,tickValues:[]};var i=b<0&&a<0,j=b;i&&(b=-a,a=-j),g=null==g?2:Math.max(1,g),_.isNumber(g)&&(g=_.range(g,1.28*g).concat(_.range(g-1,.72*(g-1),-1))),null==h&&(h=0===a||j<0);var l;l=a===b?0===b?-1:k.log10(Math.abs(b)):h?k.log10(Math.abs(b))-.5:k.log10(b-a)-.5;var m,n,o=-(l>=0?k.trunc(l):Math.floor(l)),p=function(a,b){b=null!=b?b:0;var c=function(a){return a>=0?Math.ceil(a):Math.floor(a)};return f(c(a*Math.pow(10,b)),Math.pow(10,b))},q=function(g){var j=p(Math.max(0,-a)/g,o-1),l=a===b&&0===b?1:p(b+j,o),m=0;if(!h&&a!==b){var n,q=a+j,r=k.digits(q);n=q>0?-Math.floor(nw.log10(q)):Math.max(1,Math.abs(r-2)),m=-k.roundTo(-q,n),m=0===m?0:m}for(var s=m,t=p(f(d(l,s),g),o),u=d(s,j),v=c(u,e(g,t)),w=[u],x=u,y=1;y<g;y++){var z=c(x,t);w.push(z),x=z}return Math.abs(x-v)>1e-10&&w.push(v),{min:i?-v:u,max:i?-u:v,tickValues:w.map(function(a){return i?-a:a})}},r=_.any(g,function(a){return n=q(a),m=m||n,_.all(n.tickValues,function(a){return a===Math.round(a)})});return r?n:m},extractScaleDomain:function(a,b,c,d,e){var f=null!=b?b:_.min(a),g=null!=c?c:_.max(a);d=null==d?5:d;var h=l.niceMinMax(f,g,d,e);return[h.min,h.max]},niceTicks:function(a,b,c,d){c=null==c?5:c;var e=l.niceMinMax(a,b,c,d);return e.tickValues},calcXLabelsWidths:function(a){var b=8;return _.compact(a).map(String).map(function(a){return a?nw.textBounds(a,".x.axis text").width+2*b:2*b})},doXLabelsFit:function(a,b,c){var d=nw.calcXLabelsWidths(a.map(b)),e=c.chart.plotWidth+d[0]/2+d[a.length-1]/2,f=nw.sum(d);return f<=e},getTicksThatFit:function(a,b,c){function d(){for(var d=nw.calcXLabelsWidths(a.map(b)),e=nw.sum(d),f=c.chart.plotWidth+d[0]/2+d[a.length-1]/2,g=1,h=function(a,b){return b%g===0},i=a;e>f&&0!==i.length;)g++,i=_.filter(a,h),e=nw.sum(nw.calcXLabelsWidths(i.map(b)));return i}return d()}},m={textBounds:function(a,b){var c=document.getElementsByTagName("body")[0],d=document.createElement("span"),e=document.createElement("span");d.className="contour-chart",e.style.position="absolute",e.style.width="auto",e.style.height="auto",e.style.visibility="hidden",e.style.lineHeight="100%",e.style.whiteSpace="nowrap",e.innerHTML=a,e.className=b.replace(/\./g," "),d.appendChild(e),c.appendChild(d);var f={width:e.clientWidth,height:e.clientHeight};return d.removeChild(e),c.removeChild(d),f}},n={dateDiff:function(a,b){var c=a.getTime()-b.getTime();return c/864e5}},o={merge:function(a,b){return"number"==typeof a&&(a=[a]),"number"==typeof b&&(b=[b]),a&&a.length?b&&b.length?[].concat(a,b).sort(function(a,b){return a-b}):a:b},isCorrectDataFormat:function(a){return _.isArray(a)&&_.all(a,function(a){return a.hasOwnProperty("x")&&a.hasOwnProperty("y")})},isCorrectSeriesFormat:function(a){var b=_.isArray(a)&&_.isObject(a[0]),c=_.all(a,function(a){return a.hasOwnProperty("data")}),d=_.all(a,function(a){return a.hasOwnProperty("name")}),e=b&&c&&o.isCorrectDataFormat(a[0].data);return b&&c&&d&&e},normalizeSeries:function(a,b){function c(a,b){return a.x-b.x}function d(a,d){var f={name:d,data:_.map(a,function(a,c){var d=null!=a&&a.hasOwnProperty("x"),f=function(a){return null!=a?a:null},g=function(a){return e?null==b[a]?null:b[a]+"":a};return d?_.extend(a,{x:a.x,y:f(a.y)}):{x:g(c),y:f(a)}})};return e||f.data.sort(c),f}var e=!(!b||!_.isArray(b)),f=o.isCorrectDataFormat(a),g=o.isCorrectSeriesFormat(a);return g?a:f?(e||a.sort(c),[{name:"series 1",data:a}]):_.isArray(a)?_.isObject(a[0])&&a[0].hasOwnProperty("data")||_.isArray(a[0])?_.map(a,function(a,b){return d(a.data?a.data:a,a.name?a.name:"series "+(b+1))}):[d(a,"series 1")]:a},stackLayout:function(){var a=d3.layout.stack().values(function(a){return a.data}),b=function(){var a={};return function(b,c,d){b.y0=null!=a[b.x]?a[b.x]:0,b.y=d,a[b.x]=(a[b.x]||0)+d}};return a.out(b()),a},uniq:function(a){for(var b={},c=[],d=a.length,e=0;e<d;e++){var f=a[e],g=f+"";b.hasOwnProperty(g)||(b[g]=!0,c.push(f))}return c},sum:function(a){return _.reduce(a,function(a,b){return a+=b},0)},maxTickValues:function(a,b){var c=b.length,d=[];if(a>=c)return b.slice();for(var e=Math.ceil(c/a),f=0;f<c;)d.push(b[f]),f+=e;return d},isSupportedDataFormat:function(a){return _.isArray(a)&&_.isObject(a[0])&&a[0].hasOwnProperty("data")&&_.isArray(a[0].data)||_.isArray(a[0])}},p={selectDom:function(a){return d3.select(a)[0][0]},getStyle:function(a,b){if(a){var c="string"==typeof a?this.selectDom(a):a,d=c.offsetParent?c.ownerDocument.defaultView.getComputedStyle(c,null):c.style;return b?d[b]:d}},getCentroid:function(a){var b=function(){if(a.offsetParent)return a.offsetParent;for(var b=a;b&&"svg"!==b.tagName;)b=b.parentNode;return b},c=b().getBoundingClientRect(),d=a.getBoundingClientRect();return[d.left-c.left+d.width/2,d.top-c.top+d.height/2]}},q={warning:function(a){console&&console.log&&console.log("WARNING: "+a)}};window.nw=window.nw||{},nw=_.extend({},nw,k,o,m,n,l,q,p,h,j,i),console.log("fart",nw.getStyle),_.noop||(_.noop=g)}(),function(){function a(a){return this.init(a),this}var b=this,c={chart:{animations:{enable:!0,duration:400},defaultWidth:400,defaultAspect:1/1.61803398875,width:void 0,height:void 0,margin:{top:0,right:0,bottom:0,left:0},padding:{top:null,right:null,bottom:null,left:null},internalPadding:{bottom:0,left:0},rotatedFrame:!1,plotWidth:void 0,plotHeight:void 0,plotTop:void 0,plotLeft:void 0},xAxis:{},yAxis:{},tooltip:{}};a["export"]=function(b,c){function d(a){if(!a||!a.length)return[];a[0].data&&_.each(a,d);var b=_.isObject(a[0])&&_.isDate(a[0].x),c=function(a,b){return a.x-b.x};return b&&a.sort(c),a}if("function"!=typeof c)throw new Error("Invalid render function for "+b+" visualization");a.prototype[b]=function(e,f){var g,h=this.options&&this.options.xAxis?this.options.xAxis.categories:void 0,i=_.extend({},this.options[b],f),j=!0;return e||(e=this.lastData||[],j=!1),d(e),g=new a.VisualizationContainer(e,h,i,b,c,this),g.ownData=j,this._visualizations.push(g),this.lastData=e,this},a.prototype[b].renderer=c},a.expose=function(b,c){var d=function(){var a=c;return"function"==typeof c&&(a=Object.create(c),a=c.apply(a,arguments)),_.extend(this,_.omit(a,"init")),a.init&&a.init.call(this,this.options),this._exposed.push(b),this};return a.prototype[b]=d,this},a.prototype=_.extend(a.prototype,{_visualizations:void 0,_extraOptions:void 0,_exposed:void 0,init:function(a){return this.options=a||{},this._extraOptions=[],this._visualizations=[],this._exposed=[],this},calculateWidth:function(){var a=parseInt(nw.getStyle(this.options.el,"width")||0,10),b=parseInt(nw.getStyle(this.options.el,"padding-left")||0,10),c=parseInt(nw.getStyle(this.options.el,"padding-right")||0,10),d=a-c-b;return this.options.el?d||this.options.chart.defaultWidth:this.options.chart.defaultWidth},calculateHeight:function(){var a=parseInt(nw.getStyle(this.options.el,"height")||0,10),b=parseInt(nw.getStyle(this.options.el,"padding-top")||0,10),c=parseInt(nw.getStyle(this.options.el,"padding-bottom")||0,10),d=a-b-c,e=this.options.el?d:void 0,f=this.options.chart.width,g=this.options.chart.aspect||this.options.chart.defaultAspect;return e&&e>1?e:Math.round(f*g)},calcMetrics:function(){var a=this.options;this.adjustPadding(),this.adjustTitlePadding(),a.chart.width=a.chart.width||this.calculateWidth(),a.chart.height=a.chart.height||this.calculateHeight(),this.options=_.merge(a,{chart:{plotWidth:a.chart.width-a.chart.margin.left-a.chart.margin.right-a.chart.internalPadding.left-a.chart.padding.right,plotHeight:a.chart.height-a.chart.margin.top-a.chart.margin.bottom-a.chart.padding.top-a.chart.internalPadding.bottom,plotLeft:a.chart.margin.left+a.chart.internalPadding.left,plotTop:a.chart.margin.top+a.chart.padding.top}}),(this.options.chart.plotWidth<=0||this.options.chart.plotHeight<=0)&&(console.warn("The chart has no space to render. Either the width/height is zero or you have too much padding\nWidth: "+a.chart.width+"\nHeight: "+a.chart.height+"\npadding-left: "+a.chart.padding.left+"\npadding-right: "+a.chart.padding.right+"\npadding-top: "+a.chart.padding.top+"\npadding-bottom: "+a.chart.padding.bottom),this.options.chart.plotWidth=this.options.chart.plotWidth<0?0:this.options.chart.plotWidth,this.options.chart.plotHeight=this.options.chart.plotHeight<0?0:this.options.chart.plotHeight)},adjustPadding:function(){return this},adjustTitlePadding:function(){return this},composeOptions:function(){var a=_.merge({},c),b=function(b){_.merge(a,b)},d=function(b){_.merge(a,b.renderer.defaults)};_.each(this._extraOptions,b),_.each(this._visualizations,d),this.options=_.merge(this.options,_.merge({},a,this.options))},baseRender:function(){return this.plotArea(),this},render:function(){return this.composeOptions(),this.calcMetrics(),this.baseRender(),this.renderVisualizations(),this},resize:function(a,b){return this.container&&this.container.style("height",0),delete this.options.chart.width,delete this.options.chart.height,delete this.options.chart.plotWidth,delete this.options.chart.plotHeight,delete this.options.chart.plotLeft,delete this.options.chart.plotTop,a&&(this.options.chart.width=a),b&&(this.options.chart.height=b),this},update:function(){return this.calcMetrics(),this},plotArea:function(){var a=this.options.chart;return this.container=d3.select(this.options.el),this.container.attr("style","-webkit-backface-visibility: hidden; position: relative"),this.svg?(this.svg.attr("transform","translate("+a.margin.left+","+a.margin.top+")"),d3.select(this.svg.node().parentNode).attr("viewBox","0 0 "+a.width+" "+a.height).attr("height",a.height)):this.svg=this.container.append("svg").attr("viewBox","0 0 "+a.width+" "+a.height).attr("preserveAspectRatio","xMinYMin").attr("class","contour-chart").attr("height",a.height).append("g").attr("transform","translate("+a.margin.left+","+a.margin.top+")"),this},createVisualizationLayer:function(a,b){return this.svg.append("g").attr("vis-id",b).attr("vis-type",a.type)},renderVisualizations:function(){return _.each(this._visualizations,function(a,b){var c=b+1,d=a.layer||this.createVisualizationLayer(a,c),e=_.merge({},this.options,a.options);d.attr("transform","translate("+this.options.chart.internalPadding.left+","+(this.options.chart.padding.top||0)+")"),a.layer=d,a.parent=this,a.render(d,e,this)},this),this},checkDependencies:function(a){a=_.isArray(a)?a:[a];var b=this,c=[];if(_.each(a,function(a){b._exposed.indexOf(a)===-1&&c.push(a)}),c.length)throw new Error("ERROR: Missing depeendencies in the Contour instance (ej. new Contour({}).cartesian())\n The missing dependencies are: ["+c.join(", ")+"]\nGo to http://forio.com/contour/documentation.html#key_concepts for more information")},ensureDefaults:function(a,b){if(_.isString(b)&&(b=this[b].renderer),b.defaults){var c=b.defaults;a=_.defaults(a||{},c),this.options=_.defaults(this.options,c)}},setData:function(a){return _.invoke(this._visualizations,"setData",a),this},select:function(a){return this._visualizations[a]},data:function(){},dataNormalizer:nw.normalizeSeries,isSupportedDataFormat:nw.isSupportedDataFormat}),"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=a:(b.Contour=a,"function"==typeof define&&define.amd&&define("contour",[],function(){return a}))}(),function(){function a(a,b){var c=b.chart.rotatedFrame?b.chart.plotWidth:b.chart.plotHeight,d=b.chart.rotatedFrame?[0,c]:[c,0];return a.range(d)}var b=function(a,b,c){this.data=a,this.options=b,this.domain=c};b.prototype={axis:function(){var a=this.options.yAxis,b=this.domain,c=null!=a.min?a.min:a.zeroAnchor?Math.min(0,b[0]):b[0],d=null!=a.max?a.max:b[1],e=a.tickValues||nw.niceTicks(c,d,a.ticks),f=this.numTicks(b,a.min,a.max),g=a.labels.formatter||d3.format(a.labels.format);return d3.svg.axis().scale(this._scale).tickFormat(g).tickSize(a.innerTickSize,a.outerTickSize).tickPadding(a.tickPadding).ticks(f).tickValues(e)},scale:function(b){return this._scale||(this._scale=d3.scale.linear(),this.setDomain(b)),a(this._scale,this.options),this._scale},setDomain:function(a){return this._scale.domain(a),this._niceTheScale(),this._scale},update:function(a,b){this.data=b,this.setDomain(a),this.scale()},numTicks:function(){return null!=this.options.yAxis.ticks?this.options.yAxis.ticks:void 0},_niceTheScale:function(){}},nw.addAxis("YAxis",b)}(),function(){var a={chart:{gridlines:"none",padding:{top:6,right:5,bottom:void 0,left:void 0}},xAxis:{type:null,categories:void 0,max:void 0,min:void 0,innerTickSize:6,outerTickSize:0,tickPadding:6,maxTicks:void 0,ticks:void 0,tickValues:void 0,title:void 0,titlePadding:4,innerRangePadding:.1,outerRangePadding:.1,firstAndLast:!1,orient:"bottom",labels:{format:void 0,formatter:void 0},linearDomain:!1},yAxis:{min:void 0,max:void 0,zeroAnchor:!0,smartAxis:!1,innerTickSize:6,outerTickSize:6,tickPadding:4,tickValues:void 0,ticks:void 0,title:void 0,titlePadding:4,orient:"left",labels:{verticalAlign:"middle",format:"s",formatter:void 0}}},b=function(){var b=function(a){return Math.max(a.outerTickSize||0,a.innerTickSize||0)};return{dataSrc:[],init:function(b){var c={chart:{rotatedFrame:!1,internalPadding:{bottom:void 0,left:void 0}}};this.options=b||{},_.merge(this.options,c);var d={};return this.options.xAxis&&this.options.xAxis.firstAndLast||(d={chart:{padding:{right:15}}}),this._extraOptions.push(_.merge({},a,d)),this},xDomain:[],yDomain:[],_getYScaledDomain:function(a,b){var c=this.options.yAxis,d=c.zeroAnchor&&a&&a[0]>0?0:void 0,e=null!=c.min?c.min:d;return c.tickValues?null!=c.min&&null!=c.max?[c.min,c.max]:null!=c.min?[c.min,d3.max(c.zeroAnchor?[0].concat(c.tickValues):c.tickValues)]:null!=c.max?[d3.min(c.zeroAnchor?[0].concat(c.tickValues):c.tickValues),c.max]:d3.extent(c.zeroAnchor||null!=c.min?[e].concat(c.tickValues):c.tickValues):c.smartAxis?d3.extent(c.zeroAnchor||null!=c.min?[e].concat(a):a):nw.extractScaleDomain(a,e,c.max,c.ticks)},adjustPadding:function(){var a=this.options.xAxis,b=this.options.yAxis;null==this.options.chart.padding.bottom?this.options.chart.internalPadding.bottom=this._getAdjustedBottomPadding(a):this.options.chart.internalPadding.bottom=this.options.chart.padding.bottom||0,this.options.chart.padding.top=this.options.chart.internalPadding.top=this._getAdjustedTopPadding(a),null==this.options.chart.padding.left?this.options.chart.internalPadding.left=this._getAdjustedLeftPadding(b):this.options.chart.internalPadding.left=this.options.chart.padding.left,this.options.chart.padding.right=this.options.chart.internalPadding.right=this._getAdjustedRightPadding(b)},_getAdjustedTopPadding:function(a){return this.options.chart.padding.top},_getAdjustedBottomPadding:function(a){if(0!==a.ticks){var c=this.xDomain,d=c.join("<br>"),e=nw.textBounds(d,".x.axis"),f=nw.textBounds("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",".x.axis"),g=f.height,h=a.labels&&a.labels.rotation?a.labels.rotation%360:0,i=0===h?f.height:Math.ceil(Math.abs(e.width*Math.sin(nw.degToRad(h)))+g/5);return b(a)+(a.tickPadding||0)+i}return b(a)+(a.tickPadding||0)},_getAdjustedLeftPadding:function(a){var c=this._getYScaledDomain(this.yDomain,this.options),d=d3.scale.linear().domain(c),e=d.ticks(a.ticks),f=a.labels.formatter||d3.format(a.labels.format||",.0f"),g=_.map(e,f).join("<br>"),h=nw.textBounds(g,".y.axis");return b(this.options.yAxis)+(this.options.yAxis.tickPadding||0)+h.width},_getAdjustedRightPadding:function(a){return this.options.chart.padding.right},adjustTitlePadding:function(){var a;(this.options.xAxis.title||this.options.yAxis.title)&&(this.options.xAxis.title&&(a=nw.textBounds(this.options.xAxis.title,".x.axis-title"),this.options.chart.internalPadding.bottom+=a.height+this.options.xAxis.titlePadding),this.options.yAxis.title&&(a=nw.textBounds(this.options.yAxis.title,".y.axis-title"),this.options.chart.internalPadding.left+=a.height+this.options.yAxis.titlePadding))},computeXScale:function(){if(!this.xDomain)throw new Error("You are trying to render without setting data (xDomain).");this.xScale?(this.xScaleGenerator.update(this.xDomain,this.dataSrc),this.rangeBand=this.xScaleGenerator.rangeBand()):(this.xScaleGenerator=nw.xScaleFactory(this.dataSrc,this.options),this.xScale=this.xScaleGenerator.scale(this.xDomain),this.rangeBand=this.xScaleGenerator.rangeBand())},computeYScale:function(){if(!this.yDomain)throw new Error("You are trying to render without setting data (yDomain).");var a=this._getYScaledDomain(this.yDomain,this.options);this.yScale?this.yScaleGenerator.update(a,this.dataSrc):(this.yScaleGenerator=nw.yScaleFactory(this.dataSrc,this.options,this.options.yAxis.type,this.yDomain),this.yScale=this.yScaleGenerator.scale(a))},xScale:void 0,yScale:void 0,setYDomain:function(a){this.yScaleGenerator.setDomain(a)},redrawYAxis:function(){this.svg.select(".y.axis").call(this.yAxis()),this.renderGridlines()},_animationDuration:function(){var a=this.options.chart.animations;return a&&a.enable?null!=a.duration?a.duration:400:0},computeScales:function(){return this.computeXScale(),this.computeYScale(),this},_xAxis:void 0,xAxis:function(){return this._xAxis||(this._xAxis=this.xScaleGenerator.axis().orient(this.options.xAxis.orient)),this._xAxis},_yAxis:void 0,yAxis:function(){return this._yAxis||(this._yAxis=this.yScaleGenerator.axis().orient(this.options.yAxis.orient)),this._yAxis},renderXAxis:function(){var a=this.xAxis(),b=this.options.chart.plotHeight+this.options.chart.padding.top,c=this.options.chart.internalPadding.left;return this._xAxisGroup=this.svg.selectAll(".x.axis").data([1]),this._xAxisGroup.node()?d3.select(this._xAxisGroup.node()).attr("transform","translate("+c+","+b+")"):this._xAxisGroup.enter().append("g").attr("transform","translate("+c+","+b+")").attr("class","x axis"),this._xAxisGroup.transition().duration(this._animationDuration()).call(a),this.xScaleGenerator.postProcessAxis(this._xAxisGroup),this},renderYAxis:function(){var a=this.options.chart.internalPadding.left,b=this.options.chart.padding.top;return this._yAxisGroup=this.svg.selectAll(".y.axis").data([1]),this._yAxisGroup.node()?d3.select(this._yAxisGroup.node()).attr("transform","translate("+a+","+b+")"):this._yAxisGroup.enter().append("g").attr("transform","translate("+a+","+b+")").attr("class","y axis"),this._renderYAxisElement(),this},_renderYAxisElement:function(){var a=this.options.yAxis,b={bottom:".8em",middle:".35em",top:"0"};this._yAxisGroup.transition().duration(this._animationDuration()).call(this.yAxis()).selectAll(".tick text").attr("dy",b[a.labels.verticalAlign])},renderAxisLabels:function(){var a,b,c,d,e=40/46.609;return this.options.xAxis.title&&(a=nw.textBounds(this.options.xAxis.title,".x.axis-title"),c=this.options.chart.internalPadding.bottom,b=0,d=this._xAxisGroup.selectAll(".x.axis-title").data([1]),d.node()||d.enter().append("text").attr("class","x axis-title"),d3.select(d.node()).attr("x",b).attr("y",c).attr("alignment-baseline","after-edge").attr("dx",(this.options.chart.plotWidth-a.width)/2).text(this.options.xAxis.title)),this.options.yAxis.title&&(a=nw.textBounds(this.options.yAxis.title,".y.axis-title"),c=-this.options.chart.internalPadding.left+a.height*e,b=0,d=this._yAxisGroup.selectAll(".y.axis-title").data([1]),d.node()||d.enter().append("text").attr("class","y axis-title"),d3.select(d.node()).attr("class","y axis-title").attr("transform","rotate(-90)").attr("x",b).attr("y",c).attr("dx",-(this.options.chart.plotHeight+a.width)/2).attr("dy",0).text(this.options.yAxis.title)),this},renderGridlines:function(){function a(a,b){var c=a.tickValues();if(!c){var d=a.ticks()[0];return a.scale().ticks(d).slice(1)}return b&&c.pop(),c.slice(1)}function b(a){return a.tickValues()||(a.scale().ticks?a.scale().ticks().slice(1):a.scale().domain())}var c,d,e=this.options.chart.gridlines,f="horizontal"===e||"both"===e,g="vertical"===e||"both"===e,h=this.xScale,i=this.yScale;if(f){c=a(this.yAxis(),this.options.yAxis.smartAxis);var j=this.options.chart.plotWidth;d=this._yAxisGroup.selectAll(".grid-lines").data([c]),d.enter().append("svg:g").attr("class","grid-lines");var k=d.selectAll(".grid-line").data(function(a){return a});k.transition().duration(this._animationDuration()).attr("x1",0).attr("x2",function(){return j}).attr("y1",i).attr("y2",i),k.enter().append("line").attr("class","grid-line").attr("x1",0).attr("x2",function(){return j}).attr("y1",i).attr("y2",i),k.exit().remove()}if(g){this._xAxisGroup.select("g.grid-lines").remove(),d=this._xAxisGroup.append("svg:g").attr("class","grid-lines"),c=b(this.xAxis());var l=this.rangeBand/2,m=this.options.chart.plotHeight;d.selectAll(".grid-line").data(c).enter().append("line").attr("class","grid-line").attr("x1",function(a){return h(a)+l}).attr("x2",function(a){return h(a)+l}).attr("y1",-m).attr("y2",0)}return this},renderBackground:function(){var a=this.options.chart;this.background=this.background||this.createVisualizationLayer("background",0);var b=this.background.selectAll(".plot-area-background").data([null]);return b.enter().append("rect").attr("class","plot-area-background").attr("x",a.internalPadding.left).attr("y",a.internalPadding.top).attr("width",a.plotWidth).attr("height",a.plotHeight),b.exit().remove(),this},render:function(){return this.composeOptions(),this.adjustDomain(),this.calcMetrics(),this.computeScales(),this.baseRender(),this.renderBackground().renderXAxis().renderYAxis().renderGridlines().renderAxisLabels().renderVisualizations(),this},datum:function(a,b){return _.isObject(a)&&_.isArray(a.data)?_.map(a.data,_.bind(this.datum,this)):{y:_.isObject(a)?a.y:a,x:_.isObject(a)?a.x:this.options.xAxis.categories?this.options.xAxis.categories[b]:b}},adjustDomain:function(){var a=this.getExtents();this._adjustXDomain(a),this._adjustYDomain(a),this._yAxis=null,this._xAxis=null,this.yScale=null},_adjustXDomain:function(a){this.xDomain=this.getXDomain();var b=_.filter(this._visualizations,function(a){return nw.isSupportedDataFormat(a.data)});this.dataSrc=_.flatten(_.map(b,function(a){return _.flatten(_.map(a.data,_.bind(this.datum,this)))},this));var c=this.dataSrc.length&&_.all(this.dataSrc,function(a){return+a.x!==a.x}),d=_.uniq(_.pluck(this.dataSrc,"x")),e=!!this.options.xAxis.categories&&(this.options.xAxis.categories.length===d.length&&_.intersection(this.options.xAxis.categories,d).length===d.length);!c||this.options.xAxis.categories&&e||(this.options.xAxis.categories=d)},_adjustYDomain:function(a){this.yDomain=a.length?a:[0,10],this.yMin=this.yDomain[0],this.yMax=this.yDomain[this.yDomain.length-1]},getExtents:function(a){var b=a&&"x"===a?"xExtent":"yExtent",c=_.filter(this._visualizations,function(a){return nw.isSupportedDataFormat(a.data)}),d=_.flatten(_.pluck(c,b));return d.length?d3.extent(d):[]},getXDomain:function(){var a=_.filter(this._visualizations,function(a){return nw.isSupportedDataFormat(a.data)}),b=_.uniq(_.flatten(_.pluck(a,"xDomain")));return b}}};Contour.expose("cartesian",b)}(),function(){function a(a){i?h.push(a):a()}function b(){i=!0}function c(){i=!1;var a=h.shift();a&&a()}function d(){function a(){g.encodesBase64=!!e.btoa,g.encodesBase64||j()}function d(){g.aDownloads=void 0!==document.createElement("a").download}function f(){g.savesMsBlobs=!!navigator.msSaveOrOpenBlob}function h(){var a=e.URL||e.webkitURL;g.createsObjectUrls=a&&a.createObjectURL}function i(){function a(){document.body.removeChild(d),g.exportsSvg?c():k(c)}b(),g.exportsSvg=!1;var d=document.body.appendChild(document.createElement("iframe"));d.style.visibility="hidden";var e=d.contentWindow.document;d.onload=function(){try{var b=e.querySelector("svg"),c=e.querySelector("img"),d=e.querySelector("canvas"),f=d.getContext("2d");d.width=1*c.getAttribute("width"),d.height=1*c.getAttribute("height");var h=new Image;h.width=d.width,h.height=d.height,h.onload=function(){try{f.drawImage(h,0,0,c.width,c.height),c.src=d.toDataURL(),g.exportsSvg=!0}catch(b){}a()};var i=(new XMLSerializer).serializeToString(b);h.src="data:image/svg+xml,"+encodeURIComponent(i)}catch(j){a()}},e.open(),e.write("<!DOCTYPE html>"),e.write("<html><head></head><body>"),e.write('<svg xmlns="http://www.w3.org/2000/svg" width="2" height="2" viewBox="0 0 1 1"><circle r="1" fill="red"/></svg>'),e.write('<img width="2" height="2">'),e.write("<canvas></canvas>"),e.write("</body></html>"),e.close()}function j(){function a(a){this.message=a}var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.prototype=new Error,a.prototype.name="InvalidCharacterError",e.btoa=function(c){for(var d,e,f=String(c),g=0,h=b,i="";f.charAt(0|g)||(h="=",g%1);i+=h.charAt(63&d>>8-g%1*8)){if(e=f.charCodeAt(g+=.75),e>255)throw new a('"btoa" failed: The string to be encoded contains characters outside of the Latin1 range.');d=d<<8|e}return i}}function k(a){var b=["rgbcolor.js","StackBlur.js","canvg.js"],c=b.length;_.each(b,function(b){var d=document.createElement("script");d.type="text/javascript",d.onload=function(){c--,0===c&&a()},d.src="//canvg.googlecode.com/svn/trunk/"+b,document.head.appendChild(d)})}b(),g.checked=!0,a(),d(),f(),h(),i(c)}var e=this,f={type:"image/png",fileName:"contour.png",target:void 0,backgroundColor:"#fff",width:void 0,height:void 0},g={checked:!1},h=[],i=!1,j=function(){function h(a,b,c){function d(a){return"data:image/svg+xml;base64,"+btoa(a)}function f(a){var b;b=a.split(",")[0].indexOf("base64")>=0?atob(a.split(",")[1]):unescape(a.split(",")[1]);for(var c=a.split(",")[0].split(":")[1].split(";")[0],d=new Uint8Array(b.length),e=0;e<b.length;e++)d[e]=b.charCodeAt(e);return new Blob([d],{type:c})}function h(){var b=(new XMLSerializer).serializeToString(a),e=d(b);c(e,null,function(){})}function i(){function h(){var a=k.toDataURL(b.type);if(g.createsObjectUrls){var d=f(a),h=e.URL||e.webkitURL,i=h.createObjectURL(d);c(i,d,function(){h.revokeObjectURL(i)})}else c(a,null,function(){})}function i(){var a=new Image;a.src=d(m),a.onload=function(){k.width=a.width,k.height=a.height,b.backgroundColor&&(l.fillStyle=b.backgroundColor,l.fillRect(0,0,a.width,a.height)),l.drawImage(a,0,0),h()},a.onerror=function(){throw new Error("Cannot export image")}}function j(){canvg(k,m,{ignoreMouse:!0,ignoreAnimation:!0,offsetX:void 0,offsetY:void 0,scaleWidth:void 0,scaleHeight:void 0,renderCallback:h})}var k=document.createElement("canvas"),l=k.getContext("2d"),m=(new XMLSerializer).serializeToString(a);e.canvg?j():i()}switch(b.type){case"image/svg+xml":return h();default:return i()}}function i(a,b){function c(a,b){var c=e.getComputedStyle(a),d=e.getComputedStyle(b);for(var f in c)l[f]||isFinite(f)||d[f]!==c[f]&&(b.style[f]=c[f])}function d(a,b){var e=a.cloneNode(!1);b.appendChild(e),a.tagName&&(c(a,e),_.each(a.childNodes,function(a){d(a,e)}))}function f(a){var b=document.body.appendChild(document.createElement("iframe"));b.style.visibility="hidden";var c=b.contentWindow,d=c.document;b.onload=function(){var c=d.createElement("div");d.body.appendChild(c);var e=function(){d.body.removeChild(c),document.body.removeChild(b)};a(c,e)},d.open(),d.write("<!DOCTYPE html>"),d.write("<html><head></head><body></body></html>"),d.close()}function g(a,b){var c=b.node(),d=e.getComputedStyle(a),f=e.getComputedStyle(c);for(var g in d)m[g]&&f[g]!==d[g]&&(c.style[g]=d[g]);switch(c.nodeName){case"rect":b.attr({rx:d.borderTopLeftRadius,ry:d.borderTopLeftRadius}),b.style({fill:d.backgroundColor,stroke:d.borderLeftColor,"stroke-width":d.borderLeftWidth});break;case"text":b.style({fill:d.color})}}function h(a,b){var c=d3.select(a.parentNode).select("div.contour-legend");if(!c.empty()){var d=c.node(),e=d3.select(b).select("svg").append("g").attr("transform","translate("+(d.offsetLeft+d.clientLeft)+","+(d.offsetTop+d.clientTop)+")");g(d,e);var f=e.append("rect").attr("width",d.clientWidth).attr("height",d.clientHeight);g(d,f);var h=c.selectAll(".contour-legend-entry");_.each(h[0],function(a){function b(a){return c.select(a).node()}var c=d3.select(a),d=e.append("g");g(a,d);var f=b(".contour-legend-key"),h=d.append("rect").attr("x",f.offsetLeft).attr("y",f.offsetTop).attr("width",f.offsetWidth-2).attr("height",f.offsetHeight-2);g(f,h);var i=b(".series-name"),j=d.append("text").attr("x",i.offsetLeft+1).attr("y",i.offsetTop+i.offsetHeight-i.offsetParent.clientTop-2).text(i.textContent);g(i,j)})}}f(function(c,e){d(a,c),h(a,c),b(d3.select(c).select("svg").node(),e)})}function j(a,b){return b.width&&b.height?b:b.width?{width:b.width,height:b.width*a.height/a.width}:b.height?{width:b.height*a.width/a.height,height:b.height}:a}function k(a,d,k){function l(a,b){a.setAttribute("width",o.width),a.setAttribute("height",o.height);var f;"download"!==k||g.aDownloads||g.savesMsBlobs||(f=e.open()),h(a,d,function(a,h,i){b();var j={download:function(){if(g.aDownloads){var b=document.createElement("a");b.download=d.fileName,b.href=a,document.body.appendChild(b),b.click(),document.body.removeChild(b)}else if(g.savesMsBlobs&&h)navigator.msSaveOrOpenBlob(h,d.fileName);else if(f||(f=e.open()),f)if(g.createsObjectUrls)f.location=a;else{
var j=f.document;j.write("<!DOCTYPE html>"),j.write("<html><head></head><body>"),j.write('<img src="'+a+'">'),j.write("</body></html>")}setTimeout(function(){i(),c()},1)},place:function(){var b=document.createElement("img");b.onload=function(){i(),c()},b.src=a,d3.select(d.target).node().appendChild(b)}};j[k]()})}b(),d=d||{},_.defaults(d,f);var m=a.select("svg").node(),n=m.getBoundingClientRect(),o=j(n,d);i(m,l)}var l={cssText:1,parentRule:1},m={font:1,fontFamily:1,fontSize:1,fontSizeAdjust:1,fontStretch:1,fontStyle:1,fontVariant:1,fontWeight:1,direction:1,letterSpacing:1,textDecoration:1,unicodeBidi:1,wordSpacing:1,clip:1,cursor:1,display:1,overflow:1,visibility:1,opacity:1};return{init:function(){return g.checked||a(d),this},download:function(b){var c=this.container;return a(function(){k(c,b,"download")}),this},place:function(b){var c=this.container;return a(function(){k(c,b,"place")}),this}}};Contour.expose("exportable",j)}(),Contour.version="1.0.1",function(){var a={xScaleFactory:function(a,b){var c="time"===b.xAxis.type||(_.isArray(a)&&a.length>0&&a[0].data?a[0].data[0].x&&_.isDate(a[0].data[0].x):_.isArray(a)&&a.length>0&&a[0].x&&_.isDate(a[0].x));return c&&"ordinal"!==b.xAxis.type?new nw.axes.TimeScale(a,b):b.xAxis.categories||"linear"!==b.xAxis.type?new nw.axes.OrdinalScale(a,b):new nw.axes.LinearScale(a,b)},yScaleFactory:function(a,b,c,d){var e={log:nw.axes.LogYAxis,smart:nw.axes.SmartYAxis,linear:nw.axes.YAxis};if(c||(c="linear"),"linear"===c&&b.yAxis.smartAxis&&(c="smart"),e[c])return new e[c](a,b,d);if(nw.axes[c])return new nw.axes[c](a,b,d);throw new Error('Unknown axis type: "'+c+'"')}};window.nw=window.nw||{},nw=_.extend({},nw,a)}(),function(){function a(a,b){this.options=b,this.data=a,this.init()}a.prototype={init:function(){delete this._scale},scale:function(a){return this._domain=a?this._getAxisDomain(a):this._getAxisDomain(this.data),this._scale=this._scale||d3.scale.linear(),this._scale.domain(this._domain),null==this.options.xAxis.min&&null==this.options.xAxis.max&&this._scale.nice(),this._setRange(),this._scale},axis:function(){var a=this.options.xAxis,b=a.labels.formatter||d3.format(a.labels.format||"g"),c=d3.svg.axis().scale(this._scale).tickSize(a.innerTickSize,a.outerTickSize).tickPadding(a.tickPadding).tickFormat(function(a){return _.isDate(a)?a.getDate():b(a)}),d=c.scale().ticks(),e=nw.doXLabelsFit(d,b,this.options);if(a.firstAndLast)c.tickValues(nw.firstAndLast(this._domain));else if(a.tickValues)c.tickValues(a.tickValues);else if(null!=a.ticks)c.ticks(a.ticks);else if(!e){var f=nw.getTicksThatFit(d,b,this.options);c.tickValues(f),c.ticks(f.length)}return c},update:function(a,b){this.data=b,this.scale(a)},rangeBand:function(){return 1},postProcessAxis:function(){return this},_setRange:function(){var a=this.options.chart.rotatedFrame?this.options.chart.plotHeight:this.options.chart.plotWidth,b=this.options.chart.rotatedFrame?[a,0]:[0,a];return this._scale.range(b)},_getAxisDomain:function(a){var b=this.options.xAxis.min,c=this.options.xAxis.max,d=d3.extent(a);return null==b&&null==c?d:null==b?[Math.min(d[0],c),c]:null==c?[b,Math.max(d[1],b)]:b>c?d:[b,c]}},console.log("linearsScale",nw.axes.LinearScale),nw.addAxis("LinearScale",a),console.log(nw.axes.LinearScale)}(),function(){function a(a,b){var c=b.chart.rotatedFrame?b.chart.plotWidth:b.chart.plotHeight,d=b.chart.rotatedFrame?[0,c]:[c,0];return a.range(d)}var b=function(a,b){this.data=a,this.options=b},c=nw.axes.YAxis.prototype;b.prototype=_.extend({},c,{axis:function(){var a=this.options.yAxis,b=this._scale.domain(),c=Math.ceil(Math.log(b[1])/Math.log(10)),d=a.labels.formatter||d3.format(a.labels.format||",.0f"),e=d3.svg.axis().scale(this._scale).tickSize(a.innerTickSize,a.outerTickSize).tickPadding(a.tickPadding);return a.labels.formatter?e.tickFormat(a.labels.formatter):e.ticks(a.ticks||c,d),e},scale:function(b){return this._scale||(b[0]<=.1&&(b[0]=.1),this._scale=d3.scale.log(),this.setDomain(b).clamp(!0)),a(this._scale,this.options),this._scale},update:function(a,b){this.data=b,a[0]<=.1&&(a[0]=.1),this.setDomain(a).clamp(!0),this.scale()}}),nw.addAxis("LogYAxis",b)}(),function(){function a(a,b){this.options=b,this.data=a,this.init()}a.prototype={init:function(){this.isCategorized=!0,delete this._scale},scale:function(a){return this._scale||(this._scale=new d3.scale.ordinal),this.setDomain(a||this.data),this._scale},axis:function(){var a=this.options.xAxis,b=a.labels.format?d3.format(a.labels.format):0,c=a.labels.formatter||d3.format(a.labels.format||"g"),d=a.labels.formatter||(this.isCategorized?0:b)||function(a){return _.isDate(a)?a.getDate():a},e=d3.svg.axis().scale(this._scale).innerTickSize(a.innerTickSize).outerTickSize(a.outerTickSize).tickPadding(a.tickPadding).tickFormat(d),f=this.isCategorized&&a.categories?a.categories:_.range(this._domain.length)||[],g=nw.doXLabelsFit(f,c,this.options);if(a.firstAndLast)e.tickValues(nw.firstAndLast(this._domain));else if(a.maxTicks)e.tickValues(nw.maxTickValues(a.maxTicks,this._domain));else if(a.tickValues)e.tickValues(a.tickValues);else if(null!=a.ticks)e.ticks(a.ticks),0===a.ticks&&e.tickValues([]);else if(g)e.tickValues(a.categories);else{var h=nw.getTicksThatFit(f,c,this.options);e.tickValues(h),e.ticks(h.length)}return e},postProcessAxis:function(a){var b=this.options.xAxis;if(b.labels&&null!=b.labels.rotation){var c=b.labels.rotation,d=nw.degToRad(c),e=c>0?1:c<0?-1:0,f=c<0?-1:1,g=.71,h=g/2,i=Math.cos(d),j=Math.sin(d),k=b.labels.rotation<0?"end":b.labels.rotation>0?"start":"middle";a.selectAll(".tick text").style({"text-anchor":k}).attr("transform",function(a,c,d){var e=d3.select(this).attr("x")||0,f=d3.select(this).attr("y")||0;return"rotate("+b.labels.rotation+" "+e+","+f+")"}).attr("dy",function(a,b,d){var e=0===c?g:h,k=i*e+j*e*f;return k.toFixed(4)+"em"}).attr("dx",function(a,b,c){return-(j*h-.31*e).toFixed(4)+"em"})}},update:function(a,b){this.data=b,this.scale(a)},setDomain:function(a){this._domain=a,this._scale.domain(a),this._range()},rangeBand:function(){var a=this._scale.rangeBand();return a||nw.warn("rangeBand is 0, you may have too many points in in the domain for the size of the chart (ie. chartWidth = "+this.options.chart.plotWidth+"px and "+this._domain.length+" X-axis points (plus paddings) means less than 1 pixel per band and there're no half pixels"),this._scale.rangeBand()},_range:function(){var a=this.options.chart.rotatedFrame?[this.options.chart.plotHeight,0]:[0,this.options.chart.plotWidth],b=(this._domain||[]).length,c=30,d=b<=c?"rangeRoundBands":"rangeBands";return this.isCategorized?this._scale[d](a,this.options.xAxis.innerRangePadding,this.options.xAxis.outerRangePadding):this._scale.rangePoints(a)}},nw.addAxis("OrdinalScale",a)}(),function(){function a(a,b,c,d,e,f){var g=_.uniq(nw.merge(nw.merge(a,e),f));return null==b&&null==c?g:null==b?c>d?nw.merge([c],g):[c]:null==c?b>=e?[b]:(g[0]=b,g):nw.merge([b,c],e)}var b=function(a,b,c){this.data=a,this.options=b,this.yMax=c[0],this.yMin=c[1],this.dataMax=d3.max(_.pluck(a,"y"))},c=nw.axes.YAxis.prototype;b.prototype=_.extend({},c,{axis:function(){var b=this.options.yAxis;this.domain=this._scale.domain();var d=a(this.domain,b.min,b.max,this.yMin,this.yMax,this.dataMax),e=this.numTicks(),f=c.axis.call(this);return f.ticks(e).tickValues(d)},numTicks:function(){return 3},setDomain:function(a){var b=d3.extent(a);this.yMin=b[0],this.yMax=b[1],this._scale.domain(a),this._niceTheScale()},_niceTheScale:function(){var a=.05,b=this._scale.domain(),c=this.options.yAxis.min||b[0],d=this.options.yAxis.max||this.dataMax,e=nw.roundToNextTick(d),f=Math.abs(e-d)<d*a?nw.roundToNextTick(d+d*a):e,g=[c,f];this._scale.domain(g)}}),nw.addAxis("SmartYAxis",b)}(),function(){function a(a,b){if(!a||!b)return 0;var c=a.getTime()-b.getTime();return c/864e5}function b(a,b){this.options=b,this.data=a,this.init()}b.prototype={init:function(){delete this._scale},scale:function(a){return this._scale||(this._scale=new d3.time.scale,this.setDomain(a)),this.range(),this._scale},axis:function(){var a=this.options.xAxis,b=this.getOptimalTickFormat(),c=d3.svg.axis().scale(this._scale).tickFormat(b).tickSize(a.innerTickSize,a.outerTickSize).tickPadding(a.tickPadding).tickValues(this._domain);return null!=this.options.xAxis.tickValues?c.tickValues(this.options.xAxis.tickValues):null!=this.options.xAxis.maxTicks&&this.options.xAxis.maxTicks<this._domain.length?c.tickValues(nw.maxTickValues(a.maxTicks,this._domain)):this.options.xAxis.firstAndLast&&c.tickValues(nw.firstAndLast(this._domain)),c},update:function(a,b){this.data=b,this.setDomain(a),this.scale()},setDomain:function(a){this._domain=a;var b=this._getAxisDomain(this._domain);this._scale.domain(b)},postProcessAxis:function(a){if(this.options.xAxis.firstAndLast){var b=a.selectAll(".tick text")[0];d3.select(b[0]).style({"text-anchor":"start"}),d3.select(b[b.length-1]).style({"text-anchor":"end"})}},rangeBand:function(){return 4},getOptimalTickFormat:function(){if(this.options.xAxis.labels.formatter)return this.options.xAxis.labels.formatter;if(this.options.xAxis.labels.format)return d3.time.format(this.options.xAxis.labels.format);var b=Math.abs(a(this._domain[this._domain.length-1],this._domain[0])),c=this.options.xAxis.maxTicks||1;return b<c?d3.time.format("%H:%M"):b<365?d3.time.format("%d %b"):d3.time.format("%Y")},range:function(){var a=this._getAxisRange(this._domain);return this._scale.rangeRound(a,.1)},_getAxisDomain:function(a){return this.options.xAxis.linearDomain?a:d3.extent(a)},_getAxisRange:function(a){var b=this.options.chart.rotatedFrame?this.options.chart.plotHeight:this.options.chart.plotWidth;return this.options.xAxis.linearDomain?_.range(0,b,b/(a.length-1)).concat([b]):[0,b]}},nw.addAxis("TimeScale",b)}(),function(){var a={chart:{rotatedFrame:!0},xAxis:{orient:"left"},yAxis:{orient:"bottom"}},b={init:function(){_.merge(this.options,a)},adjustPadding:function(){var a=this.options.xAxis.categories||_.pluck(this.dataSrc,"x"),b=a.join("<br>"),c=nw.textBounds(b,".x.axis"),d=nw.textBounds("ABC",".y.axis"),e=function(a){return Math.max(a.outerTickSize,a.innerTickSize)};this.options.chart.internalPadding.left=this.options.chart.padding.left||e(this.options.xAxis)+this.options.xAxis.tickPadding+c.width,this.options.chart.internalPadding.bottom=this.options.chart.padding.bottom||e(this.options.yAxis)+this.options.yAxis.tickPadding+d.height},adjustTitlePadding:function(){var a;(this.options.xAxis.title||this.options.yAxis.title)&&(this.options.xAxis.title&&(a=nw.textBounds(this.options.xAxis.title,".x.axis-title"),this.options.chart.internalPadding.left+=a.height+this.options.xAxis.titlePadding),this.options.yAxis.title&&(a=nw.textBounds(this.options.yAxis.title,".y.axis-title"),this.options.chart.internalPadding.bottom+=a.height+this.options.yAxis.titlePadding))},renderYAxis:function(){var a=this.yAxis(),b=this.options.chart.internalPadding.left,c=this.options.chart.padding.top+this.options.chart.plotHeight;return this._yAxisGroup=this.svg.selectAll(".y.axis").data([1]),this._yAxisGroup.enter().append("g").attr("class","y axis").attr("transform","translate("+b+","+c+")"),this._yAxisGroup.exit().remove(),this._yAxisGroup.transition().duration(this._animationDuration()).attr("transform","translate("+b+","+c+")").call(a),this},renderXAxis:function(){var a=this.options.chart.internalPadding.left,b=this.options.chart.padding.top,c=this.xAxis();return this._xAxisGroup=this.svg.selectAll(".x.axis").data([1]),this._xAxisGroup.enter().append("g").attr("class","x axis").attr("transform","translate("+a+","+b+")"),this._xAxisGroup.exit().remove(),this._xAxisGroup.transition().duration(this._animationDuration()).attr("transform","translate("+a+","+b+")").call(c),this.xScaleGenerator.postProcessAxis(this._xAxisGroup),this},renderAxisLabels:function(){var a,b,c,d,e,f,g,h=.25*this.titleOneEm,i=40/46.609;return this.options.xAxis.title&&(b=nw.textBounds(this.options.xAxis.title,".x.axis-title"),f=this.options.chart.rotatedFrame?-b.height:this.options.chart.plotWidth,g=this.options.chart.rotatedFrame?-this.options.chart.internalPadding.left:this.options.chart.internalPadding.bottom-h,d=this.options.chart.rotatedFrame?"-90":"0",a=this._xAxisGroup.selectAll(".x.axis-title").data([null]),a.enter().append("text").attr("class","x axis-title"),a.attr("x",0).attr("y",g).attr("transform",["rotate(",d,")"].join("")).attr("dy",b.height*i).attr("dx",-(this.options.chart.plotHeight+b.width)/2).text(this.options.xAxis.title),a.exit().remove()),this.options.yAxis.title&&(b=nw.textBounds(this.options.yAxis.title,".y.axis-title"),e=Math.max(this.options.yAxis.innerTickSize,this.options.yAxis.outerTickSize),c=this.options.chart.rotatedFrame?"end":"middle",f=this.options.chart.rotatedFrame?this.options.chart.plotWidth:0,g=this.options.chart.rotatedFrame?this.options.chart.internalPadding.bottom:-this.options.chart.internalPadding.left+this.titleOneEm-h,d=this.options.chart.rotatedFrame?"0":"-90",a=this._yAxisGroup.selectAll(".y.axis-title").data([null]),a.enter().append("text").attr("class","y axis-title"),a.attr("y",g).attr("x",f).attr("dx",-(this.options.chart.plotWidth+b.width)/2).attr("dy",-4).attr("transform",["rotate(",d,")"].join("")).text(this.options.yAxis.title),a.exit().remove()),this}};Contour.expose("horizontal",b)}(),function(){function a(a,b,c,d,e,f){this.type=d,this.renderer=e,this.ctx=f,this.categories=b,this.init(a,c)}var b=function(a,b){var c=[],d=[];return _.each(a,function(a){if(a.data.length){var e=_.pluck(a.data,b);c.push(d3.max(e)),d.push(d3.min(e))}}),d.length&&c.length?[_.min(d),_.max(c)]:[]},c=function(a){var b=nw.stackLayout(),c=b(a),d=[];return _.each(c,function(a){_.each(a.data,function(a,b){var c=d[b]||0;d[b]=c+a.y})}),[_.min(d),_.max(d)]},d=_.partialRight(b,"x"),e=_.partialRight(b,"y");a.prototype={init:function(a,b){this.setOptions(b),this.setData(a)},render:function(a,b){return this.renderer.call(this.ctx,this.data,a,b),this.ctx},setData:function(a){var b=(this.ctx||{}).dataNormalizer||nw.normalizeSeries;return this.data=b(a,this.categories),this._updateDomain(),this.ctx},setOptions:function(a){var b={};return b[this.type]=a||{},this.options={},this.options=_.merge({},(this.renderer||{}).defaults||{},b),this.ctx},_updateDomain:function(){if(!this.options[this.type])throw new Error("Set the options before calling setData or _updateDomain");var a=(this.ctx||{}).isSupportedDataFormat||nw.isSupportedDataFormat;a(this.data)&&(this.xDomain=_.flatten(_.map(this.data,function(a){return _.pluck(a.data,"x")})),this.xExtent=d(this.data,"x"),this.yExtent=this.options[this.type].stacked?c(this.data):e(this.data))}},Contour.VisualizationContainer=a}(),function(){function a(a,b,c){function d(){a=c.area.preprocess(a);var d=b.selectAll("g.series").data(k(a));d.enter().append("svg:g").attr("class",j).append("path").datum(function(a){return a.data}).attr("class","area").attr("d",l),d.exit().remove(),c.chart.animations&&c.chart.animations.enable?d.select(".area").datum(function(a){return a.data}).transition().duration(c.chart.animations.duration||f).attr("d",n):d.select(".area").datum(function(a){return a.data}).attr("d",n)}function e(){var d=10,e=b.selectAll(".tooltip-trackers").data(a,function(a){return a.name});e.enter().append("g").attr("class","tooltip-trackers"),e.exit().remove();var f=e.selectAll(".tooltip-tracker").data(function(a){return a.data},function(a,b){return[a.x,a.y,a.y0].join("&")});f.enter().append("rect").attr("class","tooltip-tracker").attr("opacity",0).attr("width",2*d),f.attr("x",function(a){return g(a.x)-d}).attr("y",function(a){return h((c.area.stacked?a.y0:0)+a.y)}).attr("height",function(a){return h(0)-h(a.y)}),f.exit().remove()}this.checkDependencies("cartesian");var f=null!=c.chart.animations.duration?c.chart.animations.duration:400,g=_.bind(function(a){return this.xScale(a)+this.rangeBand/2+.5},this),h=_.bind(function(a){return this.yScale(a)+.5},this),i=c.chart.plotHeight,j=function(a,b){return"series s-"+(b+1)+" "+a.name},k=d3.layout.stack().values(function(a){return a.data}),l=d3.svg.area().x(function(a){return g(a.x)}).y0(function(a){return i}).y1(function(a){return i}),m=null!=c.area.areaBase?c.area.areaBase:c.yAxis.min,n=d3.svg.area().x(function(a){return g(a.x)}).y0(function(a){return h(c.area.stacked?a.y0||m||0:0)}).y1(function(a){return h((c.area.stacked?a.y0:0)+a.y)});c.area.smooth&&(n.interpolate("cardinal"),l.interpolate("cardinal")),d(),c.tooltip&&c.tooltip.enable&&e()}var b={xAxis:{type:"linear"},area:{stacked:!0,areaBase:void 0,preprocess:nw.minMaxFilter(1e3)}};a.defaults=b,Contour["export"]("area",a)}(),function(){function a(a,b,c){function d(a,b){return a.attr("y",function(a){return k(a.x)+m}).attr("height",n),b?a.attr("x",function(a){return l(0)}).attr("width",function(a){return 0}):a.attr("x",function(a){return l(a.y>=0?a.y0||0:a.y+a.y0)}).attr("width",function(a){return a.y>=0?l(a.y)-l(0):l(0)-l(a.y)})}function e(b,d){var e=a.length,f=function(){return n/e-c.bar.groupPadding+.5},g=function(a,b){return n/e*b+.5};return b.attr("y",function(a,b,c){return k(a.x)+g(a,c)+m}).attr("x",l(0)).attr("height",f),d?b.attr("width",function(a){return.5}):b.attr("width",function(a){return a.y>=0?l(a.y)-l(0):l(0)-l(a.y)}).attr("x",function(a){return l(a.y<0?a.y:0)})}this.checkDependencies(["cartesian","horizontal"]);var f=null!=c.chart.animations.duration?c.chart.animations.duration:400,g=this,h=c.bar,i=h.barClass,j=h.style,k=function(a){return g.xScale(a)-.5},l=function(a){return g.yScale(a)+.5},m=nw.getValue(h.offset,0,this),n=nw.getValue(h.barWidth,this.rangeBand,this),o=nw.stackLayout(),p=c.bar.stacked?d:e,q=_.partialRight(p,!0),r=function(a,b){return"series s-"+(b+1)+" "+a.name};a=c.bar.preprocess(a);var s=b.selectAll("g.series").data(o(a));s.enter().append("svg:g").attr("class",r),s.exit().remove();var t=s.selectAll(".bar").data(function(a){return a.data}),u="bar"+(c.tooltip.enable?" tooltip-tracker":"");t.enter().append("rect").attr("class",function(a,b,c){return i?u+" "+("function"==typeof i?i.call(this,a,b,c):i):u}).call(q),c.chart.animations&&c.chart.animations.enable?(t.attr("style",j).transition().duration(f).call(p),t.exit().transition().duration(f).attr("width",l(0)).remove()):(t.attr("style",j).call(p),t.exit().remove())}var b={bar:{barClass:null,style:null,stacked:!1,groupPadding:2,barWidth:function(){return this.rangeBand},offset:function(){return 0},preprocess:function(a){return a}}};a.defaults=b,Contour["export"]("bar",a)}(),function(){function a(a,b,c){function d(a,b){var c=m(0);a.attr("x",function(a){return l(a.x)+o}).attr("width",function(){return p}),b?a.attr("y",function(a){return a.y>=0?c:c}).attr("height",function(a){return.5}):a.attr("y",function(a){return a.y>=0?m(a.y)+m(a.y0)-c:m(a.y0)}).attr("height",function(a){return a.y>=0?c-m(a.y):m(a.y)-c})}function e(b,c){var d=p/a.length-g.groupPadding+.5,e=function(b,c){return p/a.length*c+.5},f=m(0);b.attr("x",function(a,b,c){return l(a.x)+e(a,c)+o}).attr("width",d),c?b.attr("y",f).attr("height",0):b.attr("y",function(a){return a.y>=0?m(a.y):f}).attr("height",function(a){return a.y>=0?f-m(a.y):m(a.y)-f})}this.checkDependencies("cartesian");var f=null!=c.chart.animations.duration?c.chart.animations.duration:400,g=c.column,h=c.chart.plotHeight,i=c.column.columnClass,j=c.column.style,k=this,l=function(a){return Math.round(k.xScale(a))+.5},m=function(a){return Math.round(k.yScale(a))-.5},n=function(a){return a.data},o=nw.getValue(g.offset,0,this),p=nw.getValue(g.columnWidth,this.rangeBand,this),q=_.partialRight(c.column.stacked?d:e,!0),r=c.column.stacked?d:e,s=_.map(a,function(a,b){return{name:a.name,data:_.filter(a.data,function(b,c){return 0===c||l(b.x)!==l(a.data[c-1].x)})}}),t=nw.stackLayout(),u=b.selectAll("g.series").data(t(s));u.enter().append("g").attr("class",function(a,b){return"series s-"+(b+1)+" "+a.name}),u.exit().remove();var v=u.selectAll(".column").data(n,function(a){return a.x||a}),w="column"+(c.tooltip.enable?" tooltip-tracker":"");v.enter().append("rect").attr("class",function(a,b,c){return i?w+" "+("function"==typeof i?i.call(this,a,b,c):i):w}).call(q),c.chart.animations&&c.chart.animations.enable?(v.exit().transition().duration(f).attr("y",h).attr("height",function(){return.5}).remove(),v.transition().duration(f).call(r)):(v.exit().remove(),v.call(r)),v.attr("style",j)}var b={column:{columnClass:null,style:null,stacked:!1,groupPadding:1,columnWidth:function(){return this.rangeBand},offset:function(){return 0}}};a.defaults=b,Contour["export"]("column",a)}(),function(){Contour["export"]("coolNarwhal",function(a,b){b.append("path").attr("class","cool").attr("opacity",0).attr("transform","scale(.5) translate(500 150)").attr("d","M-220.02,76.509l-0.78,8.927c-0.956,10.949,1.389,20.422,6.188,30.383c10.203,21.173,63.095,84.05,93.72,115.075c20.145,20.406,19.487,23.018,21.549,40.122c2.487,20.621,24.897,66.462,40.838,71.269 c15.086,4.549,12.91-12.398,13.319-37.83c5.746,2.457,10.917,5.638,20.206,12.697c61.697,46.892,139.734,69.97,206.5,71.733c46.209,1.221,81.432-7.081,142.957-33.694c40.484-17.512,54.271-22.098,65.639-21.504c4.432,0.232,22.678,11.204,41.746,21.563c35.398,19.229,69.457,34.595,75.896,34.239c12.609-1.457-0.701-11.783-8.072-24.217c-7.049-11.892-15.414-29.572-18.844-42.134s-4.723-22.272-8.91-27.091c-2.143-2.463-12.812-6.786-21.189-8.146c-18.045-2.933-22.191-2.922-13.531-8.957c13.076-9.115,17.377-11.039,1.826-29.068c-6.383-7.402-11.336-20.003-13.709-39.542c-1.607-13.237,1.057-23.679-3.869-27.451s-17.271,12.341-20.846,19.334c-2.01,3.937-7.102,19.005-11.312,33.485c-13.795,47.427-29.865,65.742-62.693,71.447c-34.361,5.971-71.623-9.506-116.543-48.404c-13.164-11.399-29.533-25.26-39.254-36.913c-13.428-16.101-15.48-18.138-19.785-20.66c-16.166-9.472-54.98-31.694-103.525-63.815c-24.393-16.141-57.72-36.928-71.453-43.693c-27.236-13.417-68.416-28.952-90.731-46.771c-24.665-19.697-38.108-19.793-67.804-5.479c-21.429,10.328-23.941,15.298-26.52,15.726c-8.216-10.129-22.917-11.198-31.647-20.682c-9.529-10.35-28.027-14.098-37.824-24.957c-10.668-11.826-31.25-16.752-40.886-26.94c-11.339-11.989-29.387-16.096-40.838-26.637c-11.617-10.694-27.159-14.843-37.68-24.045c-10.383-9.082-23.187-12.538-31.408-19.163c-8.193-6.601-16.593-9.444-22.026-11.993c-5.433-2.549-7.398-2.522-7.658-1.927c-0.26,0.594,1.355,2.955,6.054,6.447c4.699,3.491,22.193,18.451,31.645,22.77c10.921,5.104,17.502,15.01,29.671,21.375c13.224,6.918,22.212,18.731,36.229,25.924c15.53,7.971,24.754,21.184,39.657,28.253c16.462,7.808,25.503,21.598,39.958,28.36c14.499,6.78,20.647,20.252,34.429,23.428C-238.033,58.207-227.932,70.443-220.02,76.509L-220.02,76.509z").transition().delay(300).duration(2e3).attr("opacity",1)})}(),function(){function a(a){var b=[];return["top","middle","bottom"].indexOf(a.legend.vAlign)!==-1?b.push(a.legend.vAlign):b.push("top"),["left","center","right"].indexOf(a.legend.hAlign)!==-1?b.push(a.legend.hAlign):b.push("right"),"vertical"===a.legend.direction&&b.push("vertical"),b}function b(b,c,d){var e;if(d.legend.el)for(e=d3.select(d.legend.el).node();e.firstChild;)e.removeChild(e.firstChild);else this.container.selectAll(".contour-legend").remove();var f=nw.textBounds("series",".contour-legend.contour-legend-entry"),g=b.length,h=(f.height+4)*g+12,i=(d.chart.plotHeight-h)/2,j=function(a){if("center"===d.legend.hAlign&&a.length){var b=a[0].parentNode.clientWidth,c=(d.chart.plotWidth-b)/2+d.chart.internalPadding.left;d3.select(a[0].parentNode).style("left",c+"px")}};if(d.legend.el)e=d3.select(d.legend.el);else{var k=this.container.selectAll(".contour-legend").data([null]);e=k.enter().append("div")}e.attr("class",function(){return["contour-legend"].concat(a(d)).join(" ")}),e.attr("style",function(){var a=[];if("top"===d.legend.vAlign?a.push("top: 0"):"middle"===d.legend.vAlign?a.push("top: "+i+"px"):a.push("bottom: "+(d.chart.internalPadding.bottom+5)+"px"),"left"===d.legend.hAlign)a.push("left: "+d.chart.plotLeft+"px");else if("center"===d.legend.hAlign){var b=nw.textBounds(this,".contour-legend");a.push("left: "+((d.chart.plotWidth-b.width)/2+d.chart.internalPadding.left)+"px")}else a.push("right: 10px");return a.join(";")});var l=e.selectAll(".contour-legend-entry").data(b);l.enter().append("div").attr("class",function(){return"contour-legend-entry"}),l.append("span").attr("class",function(a,b){return"contour-legend-key series s-"+(b+1)+" "+nw.seriesNameToClass(a.name)}),l.append("span").attr("class","series-name").text(d.legend.formatter).call(j),l.exit().remove()}var c={legend:{vAlign:"middle",hAlign:"right",direction:"vertical",formatter:function(a){return a.name},el:void 0}};b.defaults=c,Contour["export"]("legend",b)}(),function(){function a(a,d,f,g){function h(a){return function(b,c){return(a||"")+" s-"+(c+1)+" "+nw.seriesNameToClass(b.name)}}function i(){var a=d3.svg.line().x(function(a){return l(a)}).y(function(){return m({x:0,y:f.yAxis.min||0})}),b=d3.svg.line().x(function(a){return l(a)}).y(function(a){return m(a)});f.line.smooth&&b.interpolate("cardinal");var g=e[c],i=d.selectAll("g.series").data(o,function(a){return a.name}),j=i.enter().append("svg:g").attr("class",h("series")).append("path").attr("class","line");if(n){var k="left-to-right"===c?b:a;j.attr("d",function(a){return k(a.data)}).call(_.partial(g.enter,b))}else j.attr("d",function(a){return b(a.data)});j=i.attr("class",h("series")).select(".line"),n?j.call(_.partial(g.update,b)):j.attr("d",function(a){return b(a.data)}),n?i.exit().remove():i.exit().remove()}function j(){var a=f.line.marker.animationDelay,c=d.selectAll(".line-chart-markers").data(o,function(a){return a.name});c.enter().append("g").attr("class",h("line-chart-markers markers")),c.exit().remove();var e=c.selectAll(".dot").data(function(a){return a.data},function(a){return a.x});n?e.transition().delay(a).duration(b).attr("cx",l).attr("cy",m).attr("opacity",1):e.attr("cx",l).attr("cy",m).attr("opacity",1),e.enter().append("circle").attr("class","dot").attr("r",f.line.marker.size).attr("opacity",0).attr("cx",l).attr("cy",m).transition().delay(b).attr("opacity",1),e.exit().remove()}function k(){var a=10,b=d.selectAll(".tooltip-trackers").data(o,function(a){return a.name});b.enter().append("g").attr("class",h("tooltip-trackers")),b.exit().remove();var c=b.selectAll(".tooltip-tracker").data(function(a){return a.data},function(a){return a.x});c.enter().append("circle").attr({"class":"tooltip-tracker",r:a,opacity:0}),c.attr({cx:l,cy:m}),c.exit().remove()}this.checkDependencies("cartesian");var l=_.bind(function(a){return this.xScale(a.x)+this.rangeBand/2+.5},this),m=_.bind(function(a){return this.yScale(a.y+(a.y0||0))+.5},this),n=f.chart.animations&&f.chart.animations.enable;c=f.line.animationDirection||"left-to-right",b=null!=f.chart.animations.duration?f.chart.animations.duration:400;var o=f.line.preprocess(nw.cleanNullValues()(a));return o=f.line.stacked?d3.layout.stack().values(function(a){return a.data})(o):o,i(),f.line.marker.enable&&j(),f.tooltip&&f.tooltip.enable&&k(),this}var b,c,d={xAxis:{type:"linear"},line:{stacked:!1,smooth:!1,animationDirection:"left-to-right",marker:{enable:!0,size:3,animationDelay:0},preprocess:nw.minMaxFilter(1e3)}},e={"left-to-right":{enter:function(a){var c=this;c.each(function(){var a=this.getTotalLength();d3.select(this).attr("stroke-dasharray",a+" "+a).attr("stroke-dashoffset",a).transition().duration(b).ease("linear").attr("stroke-dashoffset",0).transition().duration(0).attr("stroke-dasharray",void 0)})},update:function(a){this.attr("d",function(b){return a(b.data)}),this.each(function(){var a=this.getTotalLength();d3.select(this).attr("stroke-dasharray",a+" "+a).attr("stroke-dashoffset",a).transition().duration(b).ease("linear").attr("stroke-dashoffset",0).transition().duration(0).attr("stroke-dasharray",void 0)})}},"bottom-to-top":{enter:function(a){this.transition().duration(b).attr("d",function(b){return a(b.data)})},update:function(a){this.transition().duration(b).attr("d",function(b){return a(b.data)})}}};a.defaults=d,Contour["export"]("line",a)}(),Contour["export"]("nullVis",_.noop),function(){function a(a){return _.isNumber(a.pie.piePadding)?{top:a.pie.piePadding,left:a.pie.piePadding,right:a.pie.piePadding,bottom:a.pie.piePadding}:a.pie.piePadding}function b(a,b,c){return{top:nw.clamp(a.top,0,c),bottom:nw.clamp(a.bottom,0,c),left:nw.clamp(a.left,0,b),right:nw.clamp(a.right,0,b)}}function c(c){var d=a(c),e=c.chart.plotWidth,f=c.chart.plotHeight;return b(d,e,f)}function d(a,b){return a>0&&a<1?b*a:a}function e(a,b,c){return{top:d(a.top,c)||5,bottom:d(a.bottom,c)||5,left:d(a.left,b)||5,right:d(a.right,b)||5}}function f(a,b,f){function g(a){function b(a){var b=d3.interpolate(this._current,a);return this._current=b(0),function(a){return c(b(a))}}var c=d3.svg.arc().outerRadius(v).innerRadius(w),d=d3.svg.arc().outerRadius(v).innerRadius(w).startAngle(0).endAngle(0),e=a.selectAll("path").data(function(a){return x(a.data)},function(a){return a.data.x});e.enter().append("path").attr("class",B).attr("d",function(a){return d(a)}).attr("style",n).each(function(a){this._current={startAngle:a.startAngle,endAngle:a.startAngle}}),i?(e.exit().remove(),e.transition().duration(h).ease("cubic-in").attrTween("d",b)):(e.exit().remove(),e.attr("d",c))}var h=null!=f.chart.animations.duration?f.chart.animations.duration:400,i=f.chart.animations&&f.chart.animations.enable,j=f.chart.plotWidth,k=f.chart.plotHeight,l=c.call(this,f),m=a.length,n=f.pie.style,o=this,p=_.all([f.pie.piePadding.left,f.pie.piePadding.right],function(a){return null==a}),q=_.all([f.pie.piePadding.top,f.pie.piePadding.bottom],function(a){return null==a}),r=e(l,j,k),s=Math.min(j,k),t=r.left+(r.right+r.left)*(m-1)+r.right,u=Math.min((j-t)/m/2,(k-r.top-r.bottom)/2),v=d(nw.getValue(f.pie.outerRadius,u,this,u,s),s),w=d(nw.getValue(f.pie.innerRadius,0,this,v),v),x=d3.layout.pie().value(function(a){return a.y}).sort(null),y=t+v*m*2,z=p?(j-y)/2:r.left,A=k/2,B=function(a,b,c){var d="series arc"+(f.tooltip.enable?" tooltip-tracker":"")+" s-"+(b+1)+" "+a.data.x;return f.pie.sliceClass?d+" "+("function"==typeof f.pie.sliceClass?f.pie.sliceClass.call(o,a,b,c):f.pie.sliceClass):d},C=function(a,b){var c=z+(2*v*b+(r.right+r.left)*b),d=q?A:v+r.top;return"translate("+(v+c)+","+d+")"},D=b.selectAll("g.pie-group").data(a);D.enter().append("svg:g").attr("class","pie-group").attr("transform",C).call(g),D.exit().remove(),i?D.call(g).transition().duration(h/2).attr("transform",C):D.call(g).attr("transform",C)}var g={pie:{sliceClass:null,style:null,piePadding:{left:null,top:null,right:null,bottom:null},innerRadius:null,outerRadius:null}};f.defaults=g,Contour["export"]("pie",f)}(),function(){function a(a,b,c){this.checkDependencies("cartesian");var d=null!=c.chart.animations.duration?c.chart.animations.duration:400,e=c.chart.animations&&c.chart.animations.enable,f=c.scatter,g=this.rangeBand/2,h=_.bind(function(a){return this.xScale(a.x)+g},this),i=_.bind(function(a){return this.yScale(a.y)},this),j=c.chart.plotHeight,k=function(a,b){return a.name+" series s-"+(b+1)};a=c.scatter.preprocess(a);var l=b.selectAll(".series").data(a);l.attr("class",k),l.enter().append("svg:g").attr("class",k),l.exit().remove();var m=l.selectAll(".dot").data(function(a){return a.data},function(a){return c.scatter.dataKey?a[c.scatter.dataKey]:a.x});m.enter().append("circle").attr("class","dot tooltip-tracker").attr("r",f.radius).attr("cx",h).attr("cy",j),e?m.transition().duration(d).attr("r",f.radius).attr("cx",h).attr("cy",i):m.attr("r",f.radius).attr("cx",h).attr("cy",i),m.exit().remove()}var b={xAxis:{type:"linear"},scatter:{radius:4,preprocess:function(a){return a}}};a.defaults=b,Contour["export"]("scatter",a)}(),function(){function a(a,b,c){var d=this.yAxis().tickFormat(),e=d3.select(c.stackTooltip.el);e.classed("stack-tooltip",!0);var f=function(b){var f=function(a){return!(a&&null!=a.y)},g=function(a,d){var e=_.isNumber(b.x)?b.x:c.xAxis.categories.indexOf(b.x);return f(a.data[e])?null:{seriesName:a.name,value:a.data[e].y,cssClass:"s-"+(d+1)}},h=_.filter(_.map(a,g),function(a){return a}),i=_.map(h,function(a){return'<span class="'+a.cssClass+'"">'+a.seriesName+": "+d(a.value)+"</span>";
}).join(" / ");e.html(i).style({display:"block"})},g=function(){e.html("")};this.svg.selectAll(".tooltip-tracker").on("mouseover.tooltip",f.bind(this)).on("mouseout.tooltip",g.bind(this))}var b={tooltip:{enable:!0}};a.defaults=b,Contour["export"]("stackTooltip",a)}(),function(){function a(a,b,c){function d(b){var c=[];return _.each(a,function(a,d){var e=a.name;_.each(a.data,function(a){a.x===b.x&&b.y===a.y&&c.push(_.extend(a,{series:e,seriesIndex:d}))})}),c}var e=function(){clearTimeout(this.tooltip.hideTimer)},f=function(a,b){this.options.tooltip.animate?this.tooltipElement.transition().duration(b).style("opacity",a):this.tooltipElement.style("opacity",a)},g=function(a){var b,d=function(){return"path"===d3.event.target.tagName?nw.getCentroid(d3.event.target):d3.mouse(this.container.node())},e=this.xScale,f=this.yScale,g=this.options.chart.plotLeft,h=this.options.chart.plotWidth,i=this.options.chart.plotTop,j=this.options.chart.plotHeight,k=this.options.tooltip.distance,l=parseFloat(this.tooltipElement.node().offsetWidth),m=parseFloat(this.tooltipElement.node().offsetHeight),n=e?e(a.x):d.call(this)[0],o=f?f(a.y):d.call(this)[1],p=function(a){return a.x<g&&(a.x=g+k),a.x+l>g+h&&(a.x-=a.x+l-(g+h),a.y=i+o-(m+k),b=!0),a.y<i&&(a.y=i+k,b&&o>=a.y&&o<=a.y+m&&(a.y=o+i+k)),a.y+m>i+j&&(a.y=Math.max(i,i+j-(m+k))),a},q={vertical:function(){var a={x:g+n-(k+l),y:i+o-(k+m)};return p(a)},horizontal:function(){var a={x:g+o-(k+l),y:i+n-(k+m)};return p(a)}};return c.chart.rotatedFrame?q.horizontal():q.vertical()},h=function(a){k.call(this,a)},i=function(){f.call(this,0,this.options.tooltip.hideTime)},j=function(a,b){function c(){var a=Array.prototype.slice.call(arguments),b=a[0],c=a.slice(1),d=_.map(b,function(a){return a.apply(this,c)}).concat([_.noop]);return _.first(_.select(d))}var d=this.options.tooltip,e=[function(a){return d.formatter?_.partial(d.formatter,a,b):null},function(a){return a.hasOwnProperty("x")?_.partial(function(a){return a.series+"<br>"+a.x+"<br>"+a.y},a):null},function(a){return a.data&&a.data.hasOwnProperty("x")?_.partial(function(a){return a.series+"<br>"+a.x+"<br>"+a.y},a.data):null},function(a){return a.hasOwnProperty("value")?_.partial(function(a){return a.value},a):null},function(){return function(){return"NA"}}];return c(e,a)()},k=function(a){e.call(this);var b=d(a);this.tooltipElement.select(".text").html(j.call(this,b[0]||a,b));var c=g.call(this,a);this.tooltipElement.style("top",c.y+"px").style("left",c.x+"px"),f.call(this,this.options.tooltip.opacity,this.options.tooltip.showTime)};this.tooltipElement=this.container.style("position","relative").selectAll(".nw-tooltip").data([1]),this.tooltipElement.enter().append("div").attr("class","nw-tooltip").style("opacity",0).append("div").attr("class","text"),this.svg.selectAll(".tooltip-tracker").on("mouseover.tooltip",h.bind(this)).on("mouseout.tooltip",i.bind(this))}var b={tooltip:{enable:!0,animate:!0,opacity:.85,showTime:300,hideTime:500,distance:5,formatter:void 0}};a.defaults=b,Contour["export"]("tooltip",a)}(),function(){function a(a){var b=_.flatten(_.pluck(a,"data")),c=b.length&&_.isNumber(b[0].x),d=function(a,b){return{x:b,y:a.y}};return c?b:_.map(b,d)}function b(b,c,d){this.checkDependencies("cartesian");var e=a(b),f=null!=d.chart.animations.duration?d.chart.animations.duration:400,g=d.chart.animations&&d.chart.animations.enable,h=_.bind(function(a){return this.xScale(a)+this.rangeBand/2},this),i=_.bind(function(a){return this.yScale(a)},this),j=nw.linearRegression(e),k=d3.extent(this.xScale.domain()),l=d3.extent(e,function(a){return a.x}),m=function(a){return j.intercept+j.slope*a},n=c.selectAll(".trend-line").data([1]);isNaN(m(l[0]))||isNaN(m(l[1]))||isNaN(h(k[0]))||isNaN(h(k[1]))?n.remove():(n.enter().append("line").attr("class","trend-line").attr("x1",h(k[0])).attr("y1",i(m(l[0]))).attr("x2",h(k[0])).attr("y2",i(m(l[0]))),n.exit().remove(),g&&(n=n.transition().duration(f)),n.attr("x1",h(k[0])).attr("y1",i(m(l[0]))).attr("x2",h(k[1])).attr("y2",i(m(l[1]))))}b.defaults={},Contour["export"]("trendLine",b)}(),b["true"]=a}({},function(){return this}());
//# sourceMappingURL=contour.min.js.map